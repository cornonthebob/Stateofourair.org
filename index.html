<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Environmental Contaminants Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.1.0"></script>

    <style>
        /* Previous CSS remains same until data-sources */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    .jump-to-graph {
    display: none;  /* Hidden by default */
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 10px 20px;
    background-color: #4a90e2;
    color: white;
    border: none;
    border-radius: 5px;
    font-weight: bold;
    z-index: 1000;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}

/* Only show on mobile devices */
@media (max-width: 768px) {
    .jump-to-graph {
        display: block;
    }
}
    .scroll-button {
    position: fixed;
    bottom: 20px;
    right: 10px;
    z-index: 1000;
    padding: 7.5px 10px;
    background-color: #4a5568;
    color: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 16px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: background-color 0.3s ease;
}

.scroll-button:hover {
    background-color: #2d3748;
}

    .info-button {
        background-color: #f0f0f0;
        color: #000000;
        border: 1px solid #ccc;
        padding: 8px 12px;
        border-radius: 10px;
        cursor: pointer;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        font-size: 14px;
        transition: background-color 0.3s, border-color 0.3s;
    }

    .info-button:hover {
        background-color: #ADD8E6;
    }

    .info-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
        width: 600px;
        text-align: center;
    }

    .close-button {
        float: right;
        font-size: 20px;
        font-weight: bold;
        cursor: pointer;
    }

    .close-button:hover {
        color: red;
    }

        body {
            background-color: rgb(249, 250, 251);
            padding: 1.5rem;
        }

        .container {
            max-width: 72rem;
            margin: 0 auto;
        }

        h1 {
            font-size: 1.875rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: rgb(31, 41, 55);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 768px) {
            .metrics-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .metric-card {
            background: white;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s;
        }

        .metric-card.selected {
            outline: 2px solid rgb(59, 130, 246);
        }

        .metric-card h2 {
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.25rem;
        }

        .metric-label {
            font-size: 0.875rem;
            color: rgb(107, 114, 128);
        }

        .chart-container {
            background: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
            height: 24rem;
        }

        .data-sources {
            background: white;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1.5rem;
            font-size: 0.875rem;
            color: rgb(107, 114, 128);
        }

        .footnote {
            font-size: 0.875rem;
            color: rgb(107, 114, 128);
            margin-bottom: 1rem;
        }
      .info-container {
    background: white;
    border-radius: 0.5rem;
    padding: 1.5rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    margin-bottom: 1.5rem;
}

.info-container h3 {
    color: rgb(31, 41, 55);
    margin-bottom: 1rem;
    font-size: 1.25rem;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 1rem;
    margin-bottom: 1rem;
}

@media (min-width: 768px) {
    .info-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

.info-card {
    background: rgb(249, 250, 251);
    padding: 1rem;
    border-radius: 0.5rem;
}

.info-card h4 {
    color: rgb(31, 41, 55);
    margin-bottom: 0.5rem;
    font-size: 1rem;
}

.info-card p {
    color: rgb(75, 85, 99);
    font-size: 0.925rem;
    line-height: 1.5;
}

.stat-highlight {
    color: rgb(220, 38, 38);
    font-weight: 600;
}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
        <h1>State of our Air</h1>
        <button class="scroll-button">ðŸ“ˆ</button>

        <button id="infoButton" class="info-button">Info</button>
    </div>

        
        <div class="metrics-grid" id="metricsGrid"></div>
        
        <div class="chart-container">
            <canvas id="metricsChart"></canvas>
        </div>

        <div class="footnote">
            * Projections (2024-2035) based on historical trends and global climate policy scenarios
        </div>
      <div class="info-container" id="contaminantInfo"></div>


        <div class="data-sources">
            <h3>Global Data Sources:</h3>
            <ul>
                <li>Lead: UNEP Global Mercury Partnership & WHO Global Health Observatory</li>
                <li>Carbon Monoxide: World Health Organization Global Air Quality Database</li>
                <li>Nitrous Oxide: World Meteorological Organization Global Atmosphere Watch</li>
                <li>Carbon Emissions: Global Carbon Project</li>
                <li>Methane: NOAA Global Monitoring Laboratory</li>
                <li>PM2.5: WHO Global Ambient Air Quality Database</li>
            </ul>
        </div>
         <div id="infoModal" class="info-modal">
        <div class="modal-content">
            <span id="closeModal" class="close-button">&times;</span>
            <i><b>Welcome to State of our Air!</b><br> This website is meant to be a simple, easy to understand site that shows you the average concentrations of pollutants in our air over time. Please note that these are global averages and specific concentrations can differ on location. <b> This is intentional </b>. Climate change is an issue all of us face, and its an issue all of us have to solve. The purpose of this site is to inspire normal peple to take action- everyone matters and together all of us can save our planet.</i>
        </div>
    </div>
    </div>
  <script>
    const infoButton = document.getElementById('infoButton');
    const infoModal = document.getElementById('infoModal');
    const closeModal = document.getElementById('closeModal');


    infoButton.addEventListener('click', () => {
        infoModal.style.display = 'flex';
    });

    closeModal.addEventListener('click', () => {
        infoModal.style.display = 'none';
    });

    window.addEventListener('click', (event) => {
        if (event.target === infoModal) {
            infoModal.style.display = 'none';
        }
    });
    const metrics = [
            { 
                id: 'lead', 
                name: 'Lead (Âµg/mÂ³)', 
                color: '#FF6B6B',
                projectionColor: 'rgba(255, 107, 107, 0.3)',
                safeLevel: 0.15,  // WHO guideline
                data: [
                    // Historical data from EPA
                    { year: 1977, value: 1.345658409 },
{ year: 1978, value: 1.258945239 },
{ year: 1979, value: 1.057395709 },
{ year: 1980, value: 0.6425786523 },
{ year: 1981, value: 0.5347730896 },
{ year: 1982, value: 0.5230550936 },
{ year: 1983, value: 0.391813539 },
{ year: 1984, value: 0.3660339479 },
{ year: 1985, value: 0.2465103893 },
{ year: 1986, value: 0.1410484258 },
{ year: 1987, value: 0.1035508388 },
{ year: 1988, value: 0.09417644201 },
{ year: 1989, value: 0.07542764849 },
{ year: 1990, value: 0.09417644201 },
{ year: 1991, value: 0.0730840493 },
{ year: 1992, value: 0.05433525579 },
{ year: 1993, value: 0.0519916566 },
{ year: 1994, value: 0.04730445822 },
{ year: 1995, value: 0.04261725984 },
{ year: 1996, value: 0.03558646228 },
{ year: 1997, value: 0.03558646228 },
{ year: 1998, value: 0.03558646228 },
{ year: 1999, value: 0.03324286309 },
{ year: 2000, value: 0.03324286309 },
{ year: 2001, value: 0.3941571382 },
{ year: 2002, value: 0.1855768104 },
{ year: 2003, value: 0.1902640088 },
{ year: 2004, value: 0.230105195 },
{ year: 2005, value: 0.1668280169 },
{ year: 2006, value: 0.1340176282 },
{ year: 2007, value: 0.1644844177 },
{ year: 2008, value: 0.1879204096 },
{ year: 2009, value: 0.1363612274 },
{ year: 2010, value: 0.2027848101 },
{ year: 2011, value: 0.1977848101 },
{ year: 2012, value: 0.1798734177 },
{ year: 2013, value: 0.1024050633 },
{ year: 2014, value: 0.05873417722 },
{ year: 2015, value: 0.03696202532 },
{ year: 2016, value: 0.03753164557 },
{ year: 2017, value: 0.03759493671 },
{ year: 2018, value: 0.0353164557 },
{ year: 2019, value: 0.02784810127 },
{ year: 2020, value: 0.02455696203 },
{ year: 2021, value: 0.02259493671 },
{ year: 2022, value: 0.02506329114 },
{ year: 2023, value: 0.02658227848 },
{ year: 2024, value: 0.02159493671 },
{ year: 2025, value: 0.02243459916 },
{ year: 2026, value: 0.022595218 },
{ year: 2027, value: 0.02219034224 },
{ year: 2028, value: 0.02086148461 },
{ year: 2029, value: 0.02004409647 },
{ year: 2030, value: 0.02033227081 },
{ year: 2031, value: 0.01946028215 },
{ year: 2032, value: 0.01870732088 },
{ year: 2033, value: 0.01813291221 },
{ year: 2034, value: 0.01773721011 },
{ year: 2035, value: 0.01718046855 },
{ year: 2036, value: 0.01644148051 },
{ year: 2037, value: 0.01593625234 },
{ year: 2038, value: 0.01540730283 },
{ year: 2039, value: 0.01482894693 },
{ year: 2040, value: 0.01421867275 },
{ year: 2041, value: 0.01365130106 },
{ year: 2042, value: 0.01311246022 },
{ year: 2043, value: 0.01252609868 },
{ year: 2044, value: 0.01194517849 },
{ year: 2045, value: 0.0113769025 },
{ year: 2046, value: 0.01081374423 },
{ year: 2047, value: 0.01024007644 },
{ year: 2048, value: 0.009662350936 },
{ year: 2049, value: 0.009094338232 },
{ year: 2050, value: 0.008524946096 }
                ],
              description: {
            what: "Lead is a toxic heavy metal that persists in the environment. It can be found in air, soil, and water, often as a result of industrial activities, past use of leaded gasoline, and old paint.",
            health: "Lead exposure can damage the brain and nervous system, kidneys, and reproductive system. Children are particularly vulnerable, with exposure leading to reduced IQ, learning difficulties, and behavioral problems.",
            effects: "Can cause anemia, weakness, kidney and brain damage, increased blood pressure, miscarriage, and death at high exposure levels.",
            stats: "WHO estimates that lead exposure accounts for 900,000 deaths per year and 21.7 million years of healthy life lost worldwide. About 30% of global children have blood lead levels exceeding 5 Î¼g/dL, the level at which action is recommended.",
            danger: "Extremely hazardous - there is no known safe blood lead level. Even low levels of lead exposure are linked to permanent cognitive impairment in children."
        }
            },
            { 
                id: 'co', 
                name: 'Carbon Monoxide (ppm)', 
                color: '#4ECDC4',
                projectionColor: 'rgba(78, 205, 196, 0.3)',
                safeLevel: 9.0,  // WHO guideline
                data: [
                    // Historical data from WHO
                    { year: 1980, value: 9.703125 },
{ year: 1981, value: 9.5609375 },
{ year: 1982, value: 8.89375 },
{ year: 1983, value: 9.4125 },
{ year: 1984, value: 8.665625 },
{ year: 1985, value: 8.0234375 },
{ year: 1986, value: 8.26875 },
{ year: 1987, value: 7.346875 },
{ year: 1988, value: 7.23125 },
{ year: 1989, value: 7.04375 },
{ year: 1990, value: 6.553125 },
{ year: 1991, value: 6.778125 },
{ year: 1992, value: 6.021875 },
{ year: 1993, value: 5.49375 },
{ year: 1994, value: 5.803125 },
{ year: 1995, value: 5.38125 },
{ year: 1996, value: 4.80625 },
{ year: 1997, value: 4.3875 },
{ year: 1998, value: 4.25 },
{ year: 1999, value: 4.334375 },
{ year: 2000, value: 3.9 },
{ year: 2001, value: 3.403125 },
{ year: 2002, value: 3.0875 },
{ year: 2003, value: 2.903125 },
{ year: 2004, value: 2.796875 },
{ year: 2005, value: 2.371875 },
{ year: 2006, value: 2.325 },
{ year: 2007, value: 2.05 },
{ year: 2008, value: 1.84375 },
{ year: 2009, value: 1.80625 },
{ year: 2010, value: 1.675 },
{ year: 2011, value: 1.671875 },
{ year: 2012, value: 1.6203125 },
{ year: 2013, value: 1.684375 },
{ year: 2014, value: 1.58125 },
{ year: 2015, value: 1.4875 },
{ year: 2016, value: 1.3640625 },
{ year: 2017, value: 1.36875 },
{ year: 2018, value: 1.515625 },
{ year: 2019, value: 1.203125 },
{ year: 2020, value: 1.790625 },
{ year: 2021, value: 1.246875 },
{ year: 2022, value: 1.2 },
{ year: 2023, value: 1.203125 },
{ year: 2024, value: 1.205994318 },
{ year: 2025, value: 1.189282025 },
{ year: 2026, value: 1.168211026 },
{ year: 2027, value: 1.138698825 },
{ year: 2028, value: 1.086694542 },
{ year: 2029, value: 1.029180128 },
{ year: 2030, value: 1.000852134 },
{ year: 2031, value: 0.9148927725 },
{ year: 2032, value: 0.9475721626 },
{ year: 2033, value: 0.9113794524 },
{ year: 2034, value: 0.8672718206 },
{ year: 2035, value: 0.8236066253 },
{ year: 2036, value: 0.7830606439 },
{ year: 2037, value: 0.7446780014 },
{ year: 2038, value: 0.7095151463 },
{ year: 2039, value: 0.6776919886 },
{ year: 2040, value: 0.6454148709 },
{ year: 2041, value: 0.6101155337 },
{ year: 2042, value: 0.5762170167 },
{ year: 2043, value: 0.5309870044 },
{ year: 2044, value: 0.4955071573 },
{ year: 2045, value: 0.461293734 },
{ year: 2046, value: 0.4268975689 },
{ year: 2047, value: 0.3918171023 },
{ year: 2048, value: 0.3560351826 },
{ year: 2049, value: 0.3195099517 },
{ year: 2050, value: 0.2825902975 }
                ],
              description: {
            what: "Carbon monoxide (CO) is a colorless, odorless gas produced by incomplete combustion of carbon-containing fuels like gasoline, natural gas, oil, coal, and wood.",
            health: "CO reduces oxygen delivery to the body's organs by binding to hemoglobin in blood. It can cause immediate health effects and worsen cardiovascular disease.",
            effects: "Causes headaches, dizziness, nausea, and at high levels can lead to unconsciousness and death within minutes. Long-term exposure linked to increased heart disease risk.",
            stats: "CO poisoning causes over 400 deaths annually in the US alone. Globally, household air pollution, including CO, leads to approximately 3.8 million premature deaths annually.",
            danger: "Highly dangerous due to being undetectable by human senses. Can be lethal within minutes at high concentrations (>1000 ppm)."
        }
            },
      { 
                id: 'methane', 
                name: 'Methane (ppb)', 
                color: '#FFB347',
                projectionColor: 'rgba(255, 179, 71, 0.3)',
                safeLevel: 722, // Pre-industrial levels + acceptable increase
                minValue: 600,
                data: [
            
{ year: 1779, value: 714.4 },
{ year: 1796, value: 716.9 },
{ year: 1798, value: 728.5 },
{ year: 1798.8, value: 710.4896326 },
{ year: 1820.4, value: 761.7 },
{ year: 1824.3, value: 784.47 },
{ year: 1827, value: 755.8 },
{ year: 1834, value: 756.3 },
{ year: 1842, value: 766.9 },
{ year: 1847, value: 763.7 },
{ year: 1852, value: 785.5 },
{ year: 1856, value: 775.9 },
{ year: 1863, value: 789.9 },
{ year: 1871, value: 811.9 },
{ year: 1879, value: 822.3 },
{ year: 1884, value: 828.5 },
{ year: 1888, value: 833.6 },
{ year: 1893, value: 836.8 },
{ year: 1894, value: 852.3 },
{ year: 1900, value: 862.4 },
{ year: 1901, value: 868.4 },
{ year: 1907, value: 888.0333333 },
{ year: 1914, value: 921.6 },
{ year: 1917, value: 929.9 },
{ year: 1926, value: 990.05 },
{ year: 1928, value: 997 },
{ year: 1931, value: 1006.4 },
{ year: 1934, value: 1023.2 },
{ year: 1936, value: 1045.2 },
{ year: 1938, value: 1053 },
{ year: 1940, value: 1059.9 },
{ year: 1941, value: 1058.95 },
{ year: 1942, value: 1069.1 },
{ year: 1944, value: 1082.5 },
{ year: 1946, value: 1081.8 },
{ year: 1950, value: 1103.3 },
{ year: 1955, value: 1142.93 },
{ year: 1956, value: 1173.3 },
{ year: 1957, value: 1182.95 },
{ year: 1961, value: 1218.5 },
{ year: 1964, value: 1260.3 },
{ year: 1965, value: 1261.3 },
{ year: 1967, value: 1284.03 },
{ year: 1970, value: 1351.7 },
{ year: 1971, value: 1357.2 },
{ year: 1972, value: 1380.1 },
{ year: 1973, value: 1385.8 },
{ year: 1974, value: 1421.5 },
{ year: 1975, value: 1420.4 },
{ year: 1977, value: 1458.1 },
{ year: 1980, value: 1479.5 },
{ year: 1984, value: 1655.82 },
{ year: 1985, value: 1635.33 },
{ year: 1986, value: 1649.795 },
{ year: 1987, value: 1662.43 },
{ year: 1988, value: 1672.89 },
{ year: 1989, value: 1686.74 },
{ year: 1990, value: 1697.1 },
{ year: 1991, value: 1707.525 },
{ year: 1992, value: 1716.255 },
{ year: 1993, value: 1741.373333 },
{ year: 1994, value: 1750.053333 },
{ year: 1995, value: 1753.623333 },
{ year: 1996, value: 1756.553333 },
{ year: 1997, value: 1762.86 },
{ year: 1998, value: 1770.566667 },
{ year: 1999, value: 1777.11 },
{ year: 2000, value: 1776.586667 },
{ year: 2001, value: 1778.726667 },
{ year: 2002, value: 1755.72 },
{ year: 2003, value: 1760.6 },
{ year: 2004, value: 1759.295 },
{ year: 2005, value: 1758.665 },
{ year: 2006, value: 1756.325 },
{ year: 2007, value: 1763.84 },
{ year: 2008, value: 1769.86 },
{ year: 2009, value: 1775.7 },
{ year: 2010, value: 1782.38 },
{ year: 2011, value: 1787.15 },
{ year: 2012, value: 1792.47 },
{ year: 2013, value: 1798.25 },
{ year: 2014, value: 1808.22 },
{ year: 2015, value: 1818.87 },
{ year: 2016, value: 1826.555 },
{ year: 2017, value: 1832.03 },
{ year: 2018, value: 1840.82 },
{ year: 2019, value: 1849.33 },
{ year: 2020, value: 1857.875 },
{ year: 2021, value: 1876.77 },
{ year: 2022, value: 1893.92 },
{ year: 2023, value: 1872.04 },
{ year: 2024, value: 1864.291455 },
{ year: 2025, value: 1870.352496 },
{ year: 2026, value: 1876.924865 },
{ year: 2027, value: 1884.194669 },
{ year: 2028, value: 1892.178216 },
{ year: 2029, value: 1900.410856 },
{ year: 2030, value: 1909.072037 },
{ year: 2031, value: 1916.178855 },
{ year: 2032, value: 1923.471155 },
{ year: 2033, value: 1930.466888 },
{ year: 2034, value: 1937.109026 },
{ year: 2035, value: 1943.150819 },
{ year: 2036, value: 1949.217361 },
{ year: 2037, value: 1955.205227 },
{ year: 2038, value: 1961.088524 },
{ year: 2039, value: 1966.917805 },
{ year: 2040, value: 1972.540092 },
{ year: 2041, value: 1977.961055 },
{ year: 2042, value: 1983.186044 },
{ year: 2043, value: 1988.522452 },
{ year: 2044, value: 1994.077823 },
{ year: 2045, value: 1999.69029 },
{ year: 2046, value: 2005.209516 },
{ year: 2047, value: 2010.884185 },
{ year: 2048, value: 2016.740239 },
{ year: 2049, value: 2022.828871 },
{ year: 2050, value: 2030.026075 }
                ],
        description: {
            what: "Methane (CHâ‚„) is a potent greenhouse gas that's 25 times more effective at trapping heat than COâ‚‚ over a 100-year period. Major sources include agriculture, landfills, and oil/gas operations.",
            health: "While not directly toxic at typical atmospheric concentrations, methane contributes significantly to climate change and ground-level ozone formation.",
            effects: "Primary environmental impact is global warming. Also contributes to ground-level ozone, which can cause respiratory problems and crop damage.",
            stats: "Atmospheric methane has increased 150% since 1750. Currently rising by ~7 ppb annually. Responsible for about 30% of global warming since pre-industrial times.",
            danger: "Critical environmental concern. While not directly toxic, its contribution to climate change poses severe long-term risks to human health and ecosystems."
        }
            },
            { 
                id: 'pm25', 
                name: 'PM2.5 (Âµg/mÂ³)', 
                color: '#A78BFA',
                projectionColor: 'rgba(167, 139, 250, 0.3)',
                safeLevel: 12, // WHO Air Quality Guidelines
                minValue: 2,
                data: [
                    { year: 1998, value: 14.95112366 },
{ year: 1999, value: 14.04533167 },
{ year: 2000, value: 16.93102611 },
{ year: 2001, value: 17.97632901 },
{ year: 2002, value: 17.56067707 },
{ year: 2003, value: 17.38453941 },
{ year: 2004, value: 17.89731398 },
{ year: 2005, value: 17.55779631 },
{ year: 2006, value: 17.47754668 },
{ year: 2007, value: 18.026948 },
{ year: 2008, value: 18.43889611 },
{ year: 2009, value: 18.05410942 },
{ year: 2010, value: 18.65536435 },
{ year: 2011, value: 18.49157279 },
{ year: 2012, value: 18.93603229 },
{ year: 2013, value: 17.64380746 },
{ year: 2014, value: 17.22404015 },
{ year: 2015, value: 18.75166391 },
{ year: 2016, value: 17.62569985 },
{ year: 2017, value: 17.58619234 },
{ year: 2018, value: 16.9804105 },
{ year: 2019, value: 16.99152199 },
{ year: 2020, value: 17.18576725 },
{ year: 2021, value: 17.17136347 },
{ year: 2022, value: 17.97920976 },
{ year: 2023, value: 18.14882044 },
{ year: 2024, value: 18.02299001 },
{ year: 2025, value: 17.76352846 },
{ year: 2026, value: 17.68248897 },
{ year: 2027, value: 17.67423541 },
{ year: 2028, value: 17.630191 },
{ year: 2029, value: 17.56211152 },
{ year: 2030, value: 17.52683251 },
{ year: 2031, value: 17.4587043 },
{ year: 2032, value: 17.37276274 },
{ year: 2033, value: 17.32270507 },
{ year: 2034, value: 17.30825537 },
{ year: 2035, value: 17.26802481 },
{ year: 2036, value: 17.28292885 },
{ year: 2037, value: 17.2993497 },
{ year: 2038, value: 17.37048567 },
{ year: 2039, value: 17.35306999 },
{ year: 2040, value: 17.29782196 },
{ year: 2041, value: 17.36993009 },
{ year: 2042, value: 17.36677717 },
{ year: 2043, value: 17.36212181 },
{ year: 2044, value: 17.30439537 },
{ year: 2045, value: 17.23461563 },
{ year: 2046, value: 17.16802446 },
{ year: 2047, value: 17.08899389 },
{ year: 2048, value: 17.07005798 },
{ year: 2049, value: 17.07225944 },
{ year: 2050, value: 17.07427603 }
                ],
              description: {
            what: "PM2.5 refers to airborne particles less than 2.5 micrometers in diameter, including dust, smoke, and liquid droplets. Sources include vehicle emissions, industrial processes, and natural sources.",
            health: "These particles can penetrate deep into the lungs and enter the bloodstream, causing respiratory and cardiovascular problems.",
            effects: "Causes asthma, bronchitis, heart attacks, and premature death. Long-term exposure linked to reduced life expectancy and cognitive decline.",
            stats: "WHO estimates that air pollution (primarily PM2.5) causes 7 million premature deaths annually. 99% of the global population breathes air exceeding WHO air quality limits.",
            danger: "One of the most dangerous environmental health risks globally. Recent research suggests no safe level of exposure exists."
        }
            },
            { 
                id: 'no', 
                name: 'Nitrous Oxide (ppb)', 
                color: '#45B7D1',
                projectionColor: 'rgba(69, 183, 209, 0.3)',
                safeLevel: 270.0,  // Pre-industrial baseline
                data: [
  { year: 1821, value: 266.5 },
  { year: 1937, value: 284.5 },
  { year: 1979, value: 300.1721667 },
  { year: 1980, value: 300.9288333 },
  { year: 1981, value: 300.8465455 },
  { year: 1982, value: 302.731 },
  { year: 1983, value: 303.5336667 },
  { year: 1984, value: 304.03775 },
  { year: 1985, value: 304.2724167 },
  { year: 1986, value: 304.5736667 },
  { year: 1987, value: 305.1549091 },
  { year: 1988, value: 306.0085 },
  { year: 1989, value: 307.05575 },
  { year: 1990, value: 308.0556667 },
  { year: 1991, value: 308.7190833 },
  { year: 1992, value: 309.3621667 },
  { year: 1993, value: 309.2550833 },
  { year: 1994, value: 309.924 },
  { year: 1995, value: 310.4980833 },
  { year: 1996, value: 311.1914167 },
  { year: 1997, value: 312.2283333 },
  { year: 1998, value: 312.9469584 },
  { year: 1999, value: 314.3751667 },
  { year: 2000, value: 315.3890625 },
  { year: 2001, value: 316.1271875 },
  { year: 2002, value: 316.4967778 },
  { year: 2003, value: 317.4572917 },
  { year: 2004, value: 318.1602708 },
  { year: 2005, value: 318.9034792 },
  { year: 2006, value: 319.6905834 },
  { year: 2007, value: 320.4139167 },
  { year: 2008, value: 321.5069792 },
  { year: 2009, value: 322.2525208 },
  { year: 2010, value: 323.1508068 },
  { year: 2011, value: 324.0481667 },
  { year: 2012, value: 324.9827292 },
  { year: 2013, value: 325.8743333 },
  { year: 2014, value: 326.9193334 },
  { year: 2015, value: 327.9347292 },
  { year: 2016, value: 328.742375 },
  { year: 2017, value: 329.5193333 },
  { year: 2018, value: 330.9334792 },
  { year: 2019, value: 331.49925 },
  { year: 2020, value: 332.9555208 },
  { year: 2021, value: 334.27875 },
  { year: 2022, value: 335.7028258 },
  { year: 2023, value: 336.5316667 },
  { year: 2024, value: 336.0138747 },
  { year: 2025, value: 336.9080621 },
  { year: 2026, value: 337.8087458 },
  { year: 2027, value: 338.6759888 },
  { year: 2028, value: 339.5980478 },
  { year: 2029, value: 340.531332 },
  { year: 2030, value: 341.4624382 },
  { year: 2031, value: 342.3771787 },
  { year: 2032, value: 343.2751372 },
  { year: 2033, value: 344.1662171 },
  { year: 2034, value: 345.0618476 },
  { year: 2035, value: 345.9717689 },
  { year: 2036, value: 346.895749 },
  { year: 2037, value: 347.8192145 },
  { year: 2038, value: 348.7402918 },
  { year: 2039, value: 349.6203387 },
  { year: 2040, value: 350.4901258 },
  { year: 2041, value: 351.3427851 },
  { year: 2042, value: 352.1812639 },
  { year: 2043, value: 353.0212458 },
  { year: 2044, value: 353.8927017 },
  { year: 2045, value: 354.7684497 },
  { year: 2046, value: 355.6701671 },
  { year: 2047, value: 356.5664147 },
  { year: 2048, value: 357.4517181 },
  { year: 2049, value: 358.3347184 },
  { year: 2050, value: 359.20272 }
],
              description: {
    what: "Nitrous Oxide (NO) is a reactive gas primarily emitted from vehicle exhaust, industrial activities, and agricultural processes like fertilizer use. It contributes significantly to ozone formation at ground level.",
    health: "Exposure to high levels can irritate the respiratory system and exacerbate conditions like asthma. Long-term exposure contributes to chronic respiratory diseases.",
    effects: "Leads to the formation of smog and acid rain, affecting both ecosystems and human health. Also contributes to global warming as a greenhouse gas.",
    stats: "Nitrogen oxides, including Nitrous Oxide, are responsible for approximately 16% of the pollutants causing smog in urban areas globally.",
    danger: "A major pollutant contributing to air quality degradation and climate change. Persistent emissions harm ecosystems and public health worldwide."
}

            },
            { 
                id: 'carbon', 
                name: 'Carbon Emissions (GT)', 
                color: '#96CEB4',
                projectionColor: 'rgba(150, 206, 180, 0.3)',
                safeLevel: 350.0,  // Paris Agreement target
                data: [
                    // Historical data from Global Carbon Projec
{ year: 1779.4891, value: 280.2362982 },
{ year: 1780.2999, value: 273.073717 },
{ year: 1794.0965, value: 281.617118 },
{ year: 1795.9435, value: 282.3047107 },
{ year: 1796.4715, value: 280.4044367 },
{ year: 1799.3364, value: 282.7995519 },
{ year: 1813.6597, value: 284.4312876 },
{ year: 1824.745, value: 281.3603653 },
{ year: 1826.9223, value: 285.9089399 },
{ year: 1832.873776, value: 285.0861667 },
{ year: 1833.1772, value: 283.8203923 },
{ year: 1836.7002, value: 284.151984 },
{ year: 1840.828157, value: 283.6545457 },
{ year: 1843.293213, value: 281.5814826 },
{ year: 1844.46111, value: 283.5311237 },
{ year: 1844.654654, value: 283.182872 },
{ year: 1845.904891, value: 283.6198857 },
{ year: 1847.3218, value: 286.8392375 },
{ year: 1850.262382, value: 284.001634 },
{ year: 1850.827, value: 288.7903954 },
{ year: 1851.105647, value: 285.4658309 },
{ year: 1853.708275, value: 288.0544375 },
{ year: 1854.718381, value: 285.5655772 },
{ year: 1856.620328, value: 283.1621007 },
{ year: 1858.844041, value: 286.6330756 },
{ year: 1861.834481, value: 287.1745622 },
{ year: 1862.978556, value: 285.3533188 },
{ year: 1864.128382, value: 286.6541582 },
{ year: 1866.743888, value: 285.0522923 },
{ year: 1867.7304, value: 287.9922513 },
{ year: 1868.414913, value: 289.5361449 },
{ year: 1869.656122, value: 287.9864944 },
{ year: 1870.044686, value: 286.3257815 },
{ year: 1872.826378, value: 286.6550967 },
{ year: 1873.73798, value: 291.5581975 },
{ year: 1876.905217, value: 289.3281311 },
{ year: 1879.950584, value: 287.7707292 },
{ year: 1882.922354, value: 292.4639348 },
{ year: 1883.791472, value: 289.7624132 },
{ year: 1884.1799, value: 289.2265988 },
{ year: 1885.600129, value: 288.1157637 },
{ year: 1887.394467, value: 294.3417875 },
{ year: 1889.007481, value: 292.3423879 },
{ year: 1889.868942, value: 290.9175394 },
{ year: 1892.390519, value: 295.1719293 },
{ year: 1892.878396, value: 294.8594308 },
{ year: 1893.0603, value: 295.3164627 },
{ year: 1893.658821, value: 293.1665417 },
{ year: 1893.756325, value: 293.8088307 },
{ year: 1898.65716, value: 295.2814575 },
{ year: 1898.942405, value: 297.0473645 },
{ year: 1900.178351, value: 294.2207216 },
{ year: 1901.701875, value: 295.6106368 },
{ year: 1903.906525, value: 295.9913578 },
{ year: 1905.350804, value: 299.0235966 },
{ year: 1905.543563, value: 297.3282186 },
{ year: 1905.7742, value: 299.6268629 },
{ year: 1908.523908, value: 301.5041354 },
{ year: 1909.764769, value: 297.8691068 },
{ year: 1910.715851, value: 298.106247 },
{ year: 1911.095388, value: 297.7268154 },
{ year: 1911.285014, value: 299.2572775 },
{ year: 1912.51514, value: 301.2977262 },
{ year: 1914.392996, value: 300.7000887 },
{ year: 1915.786031, value: 301.9151507 },
{ year: 1917.874588, value: 303.8522213 },
{ year: 1918.668399, value: 304.6132073 },
{ year: 1919.707781, value: 301.8758604 },
{ year: 1922.505042, value: 303.1815383 },
{ year: 1922.836883, value: 306.1986243 },
{ year: 1924.748381, value: 304.7159147 },
{ year: 1925.313043, value: 304.9691568 },
{ year: 1927.79646, value: 308.0187419 },
{ year: 1928.1568, value: 305.6678685 },
{ year: 1928.539307, value: 305.7053722 },
{ year: 1928.7436, value: 305.7829415 },
{ year: 1929.386326, value: 305.3808267 },
{ year: 1930.829694, value: 305.7409187 },
{ year: 1932.293604, value: 308.2555622 },
{ year: 1932.537299, value: 308.2791992 },
{ year: 1932.780924, value: 305.9440282 },
{ year: 1933.593049, value: 307.0755443 },
{ year: 1933.876425, value: 309.6306261 },
{ year: 1935.056301, value: 306.3197984 },
{ year: 1935.709457, value: 307.2585986 },
{ year: 1935.873358, value: 309.3446869 },
{ year: 1936.863214, value: 307.4076932 },
{ year: 1937.766693, value: 312.3293255 },
{ year: 1937.86788, value: 311.5205097 },
{ year: 1938.129852, value: 311.9410288 },
{ year: 1938.1616, value: 308.4798278 },
{ year: 1938.967723, value: 310.4566675 },
{ year: 1939.222485, value: 311.2117943 },
{ year: 1939.591827, value: 310.9510867 },
{ year: 1939.969, value: 309.800915 },
{ year: 1940.754009, value: 307.7386636 },
{ year: 1940.839415, value: 311.8022677 },
{ year: 1941.779698, value: 312.3939386 },
{ year: 1942.035413, value: 312.843733 },
{ year: 1942.207341, value: 311.8780536 },
{ year: 1943.573648, value: 312.3616402 },
{ year: 1944.509043, value: 310.2243096 },
{ year: 1944.764323, value: 311.2775835 },
{ year: 1944.96281, value: 310.4402044 },
{ year: 1945.387389, value: 311.8114965 },
{ year: 1945.55722, value: 311.9671347 },
{ year: 1945.615839, value: 312.5596868 },
{ year: 1946.62686, value: 312.8663621 },
{ year: 1946.663397, value: 310.3629002 },
{ year: 1947.706487, value: 311.57095 },
{ year: 1948.774055, value: 309.6939936 },
{ year: 1949.668472, value: 313.6602846 },
{ year: 1950.2509, value: 312.0017776 },
{ year: 1952.383918, value: 312.1844627 },
{ year: 1953.558561, value: 312.2227408 },
{ year: 1953.713937, value: 312.8003638 },
{ year: 1953.791544, value: 313.171057 },
{ year: 1954.795965, value: 314.7139613 },
{ year: 1956.1572, value: 315.3420739 },
{ year: 1957.103747, value: 314.4370578 },
{ year: 1957.203374, value: 316.3253802 },
{ year: 1957.257539, value: 315.2703546 },
{ year: 1957.872424, value: 314.5721663 },
{ year: 1958.102786, value: 316.1014029 },
{ year: 1958.562971, value: 316.33402 },
{ year: 1959, value: 315.98 },
{ year: 1959.092696, value: 311.9838924 },
{ year: 1960, value: 316.91 },
{ year: 1960.314045, value: 313.0933881 },
{ year: 1960.568662, value: 318.2065804 },
{ year: 1961, value: 317.64 },
{ year: 1961.7159, value: 316.5926101 },
{ year: 1962, value: 318.45 },
{ year: 1962.321916, value: 317.521628 },
{ year: 1962.395341, value: 319.1381732 },
{ year: 1962.542092, value: 317.4481355 },
{ year: 1962.61528, value: 318.6110626 },
{ year: 1963, value: 318.99 },
{ year: 1963.200018, value: 319.0660644 },
{ year: 1963.564496, value: 319.123473 },
{ year: 1964, value: 319.62 },
{ year: 1965, value: 320.04 },
{ year: 1965.226349, value: 319.8929363 },
{ year: 1965.297878, value: 319.1950596 },
{ year: 1965.866012, value: 320.9815664 },
{ year: 1966, value: 321.37 },
{ year: 1966.545235, value: 322.1747797 },
{ year: 1966.789044, value: 320.4923554 },
{ year: 1967, value: 322.18 },
{ year: 1968, value: 323.05 },
{ year: 1968.538749, value: 320.3806508 },
{ year: 1968.813869, value: 324.0855174 },
{ year: 1968.984371, value: 325.0771759 },
{ year: 1969, value: 324.62 },
{ year: 1969.423218, value: 324.7060576 },
{ year: 1970, value: 325.68 },
{ year: 1970.221683, value: 324.5570617 },
{ year: 1970.63715, value: 324.9059937 },
{ year: 1970.656302, value: 326.6491948 },
{ year: 1970.872682, value: 326.3093257 },
{ year: 1971, value: 326.32 },
{ year: 1972, value: 327.46 },
{ year: 1972.041018, value: 330.3504422 },
{ year: 1972.088334, value: 328.415888 },
{ year: 1973, value: 329.68 },
{ year: 1974, value: 331.966 },
{ year: 1974.133413, value: 331.5498057 },
{ year: 1975, value: 332.3905 },
{ year: 1975.570921, value: 332.3656863 },
{ year: 1976, value: 331.65 },
{ year: 1976.67037, value: 332.3689555 },
{ year: 1976.79675, value: 335.5469535 },
{ year: 1977, value: 332.917 },
{ year: 1978, value: 334.721 },
{ year: 1979, value: 336.5895 },
{ year: 1979.14259, value: 334.8485555 },
{ year: 1980, value: 338.1112 },
{ year: 1981, value: 339.5624 },
{ year: 1982, value: 340.5512 },
{ year: 1983, value: 342.0728 },
{ year: 1983.025919, value: 339.4604885 },
{ year: 1983.07685, value: 341.3292967 },
{ year: 1984, value: 343.9124 },
{ year: 1984.916753, value: 342.0519764 },
{ year: 1985, value: 345.1714 },
{ year: 1985.76218, value: 343.1107521 },
{ year: 1986, value: 346.5816 },
{ year: 1986.143228, value: 343.9736768 },
{ year: 1986.616016, value: 344.7177686 },
{ year: 1987, value: 348.1688 },
{ year: 1987.208592, value: 345.441206 },
{ year: 1988, value: 350.5378 },
{ year: 1988.069512, value: 347.5974056 },
{ year: 1988.966335, value: 349.2784146 },
{ year: 1989, value: 352.1554 },
{ year: 1989.407968, value: 349.8002704 },
{ year: 1989.9714, value: 350.8086522 },
{ year: 1990, value: 353.3308 },
{ year: 1991, value: 354.7188 },
{ year: 1991.134817, value: 352.4163084 },
{ year: 1992, value: 355.6244 },
{ year: 1992.313517, value: 353.7242358 },
{ year: 1993, value: 357.0442857 },
{ year: 1993.08, value: 353.9466853 },
{ year: 1994, value: 358.5511429 },
{ year: 1994.405642, value: 357.1067397 },
{ year: 1995, value: 360.5625714 },
{ year: 1996, value: 362.1182857 },
{ year: 1996.279272, value: 359.6477932 },
{ year: 1997, value: 363.3192857 },
{ year: 1998, value: 365.4177171 },
{ year: 1999, value: 368.0534286 },
{ year: 2000, value: 369.2837143 },
{ year: 2001, value: 370.4253333 },
{ year: 2001.03, value: 368.0224879 },
{ year: 2003, value: 374.8148 },
{ year: 2004, value: 376.5556 },
{ year: 2005, value: 378.6664 },
{ year: 2006, value: 380.7326 },
{ year: 2007, value: 382.608 },
{ year: 2008, value: 384.6466 },
{ year: 2009, value: 386.157 },
{ year: 2010, value: 388.3058 },
{ year: 2011, value: 390.2468 },
{ year: 2012, value: 392.2944 },
{ year: 2013, value: 395.0612 },
{ year: 2014, value: 397.0422 },
{ year: 2015, value: 399.341 },
{ year: 2016, value: 402.51 },
{ year: 2017, value: 404.9324 },
{ year: 2018, value: 407.2022 },
{ year: 2019, value: 409.7286 },
{ year: 2020, value: 412.3595 },
{ year: 2021, value: 414.3504 },
{ year: 2022, value: 416.681 },
{ year: 2023, value: 418.8174 },
{ year: 2024, value: 417.4993532 },
{ year: 2025, value: 419.5858223 },
{ year: 2026, value: 421.5901412 },
{ year: 2027, value: 423.5917662 },
{ year: 2028, value: 425.6887082 },
{ year: 2029, value: 427.6942604 },
{ year: 2030, value: 429.8197182 },
{ year: 2031, value: 431.861416 },
{ year: 2032, value: 433.9035094 },
{ year: 2033, value: 436.0499391 },
{ year: 2034, value: 438.1059557 },
{ year: 2035, value: 440.1634439 },
{ year: 2036, value: 442.3180066 },
{ year: 2037, value: 444.4637202 },
{ year: 2038, value: 446.5362495 },
{ year: 2039, value: 448.6653135 },
{ year: 2040, value: 450.7160214 },
{ year: 2041, value: 452.8389175 },
{ year: 2042, value: 454.8508763 },
{ year: 2043, value: 456.9630656 },
{ year: 2044, value: 458.9968426 },
{ year: 2045, value: 461.1183778 },
{ year: 2046, value: 463.2297883 },
{ year: 2047, value: 465.2256725 },
{ year: 2048, value: 467.3049143 },
{ year: 2049, value: 469.3899682 },
{ year: 2050, value: 471.5040056 }
                ],
              description: {
    "what": "Carbon Dioxide (CO2) is a colorless, odorless gas naturally present in Earth's atmosphere as part of the carbon cycle. It is also released through human activities such as fossil fuel combustion, deforestation, and industrial processes.",
    "health": "While CO2 is not directly harmful to human health at typical atmospheric levels, elevated concentrations in enclosed spaces can cause dizziness, headaches, and respiratory distress. Indirectly, its contribution to climate change exacerbates heatwaves and air quality issues, affecting public health.",
    "effects": "As the primary greenhouse gas emitted by human activities, CO2 traps heat in the atmosphere, leading to global warming. This results in rising sea levels, more extreme weather events, and disruptions to ecosystems and biodiversity.",
    "stats": "CO2 accounts for approximately 76% of total greenhouse gas emissions globally, with atmospheric concentrations exceeding 420 ppm as of 2023, compared to pre-industrial levels of about 280 ppm.",
    "danger": "The leading driver of climate change, CO2 emissions threaten global ecosystems, economies, and human well-being. Continued emissions risk irreversible damage to the planet's climate systems."
}

            }
        ];
    
    let selectedMetric = 'lead';
    let chart;
    function updateContaminantInfo(metricId) {
    const metric = metrics.find(m => m.id === metricId);
    const infoContainer = document.getElementById('contaminantInfo');
    const heatData = [{ year: 1780, value: 51.25492235 },
{ year: 1787, value: 51.30885399 },
{ year: 1792, value: 51.23126004 },
{ year: 1799, value: 51.16134866 },
{ year: 1804, value: 51.06454828 },
{ year: 1807, value: 50.9626774 },
{ year: 1808, value: 50.8409855 },
{ year: 1814, value: 50.93317634 },
{ year: 1818, value: 51.1106437 },
{ year: 1821, value: 51.25123472 },
{ year: 1826, value: 51.22972353 },
{ year: 1830, value: 51.05532919 },
{ year: 1833, value: 50.87239867 },
{ year: 1839, value: 50.80871871 },
{ year: 1842, value: 50.92395725 },
{ year: 1845, value: 51.32367038 },
{ year: 1844, value: 51.13830095 },
{ year: 1849, value: 51.43254337 },
{ year: 1853, value: 51.38491143 },
{ year: 1853, value: 51.32129976 },
{ year: 1854, value: 51.18670114 },
{ year: 1861, value: 51.3319017 },
{ year: 1859, value: 51.2051393 },
{ year: 1865, value: 51.39566703 },
{ year: 1870, value: 51.37722886 },
{ year: 1875, value: 52.5 },
{ year: 1876, value: 51.5 },
{ year: 1877, value: 52.0 },
{ year: 1878, value: 52.5 },
{ year: 1879, value: 52.7 },
{ year: 1880, value: 48.6 },
{ year: 1881, value: 52.3 },
{ year: 1882, value: 49.6 },
{ year: 1883, value: 50.8 },
{ year: 1884, value: 51.0 },
{ year: 1885, value: 52.8 },
{ year: 1886, value: 52.0 },
{ year: 1887, value: 52.6 },
{ year: 1888, value: 53.0 },
{ year: 1889, value: 52.9 },
{ year: 1890, value: 51.4 },
{ year: 1891, value: 50.8 },
{ year: 1892, value: 51.2 },
{ year: 1893, value: 50.3 },
{ year: 1894, value: 51.0 },
{ year: 1895, value: 50.4 },
{ year: 1896, value: 51.6 },
{ year: 1897, value: 50.6 },
{ year: 1898, value: 49.7 },
{ year: 1899, value: 51.0 },
{ year: 1900, value: 53.9 },
{ year: 1901, value: 53.5 },
{ year: 1902, value: 52.1 },
{ year: 1903, value: 50.6 },
{ year: 1904, value: 51.8 },
{ year: 1905, value: 51.7 },
{ year: 1906, value: 51.2 },
{ year: 1907, value: 52.4 },
{ year: 1908, value: 50.1 },
{ year: 1909, value: 51.8 },
{ year: 1910, value: 54.5 },
{ year: 1911, value: 51.2 },
{ year: 1912, value: 50.9 },
{ year: 1913, value: 51.3 },
{ year: 1914, value: 53.2 },
{ year: 1915, value: 53.2 },
{ year: 1916, value: 51.1 },
{ year: 1917, value: 50.7 },
{ year: 1918, value: 52.3 },
{ year: 1919, value: 52.5 },
{ year: 1920, value: 51.3 },
{ year: 1921, value: 54.4 },
{ year: 1922, value: 51.2 },
{ year: 1923, value: 50.8 },
{ year: 1924, value: 51.5 },
{ year: 1925, value: 53.1 },
{ year: 1926, value: 53.9 },
{ year: 1927, value: 52.5 },
{ year: 1928, value: 50.7 },
{ year: 1929, value: 49.3 },
{ year: 1930, value: 49.4 },
{ year: 1931, value: 49.9 },
{ year: 1932, value: 48.2 },
{ year: 1933, value: 50.5 },
{ year: 1934, value: 55.3 },
{ year: 1935, value: 51.9 },
{ year: 1936, value: 52.2 },
{ year: 1937, value: 51.4 },
{ year: 1938, value: 52.0 },
{ year: 1939, value: 51.7 },
{ year: 1940, value: 53.8 },
{ year: 1941, value: 51.5 },
{ year: 1942, value: 49.7 },
{ year: 1943, value: 52.2 },
{ year: 1944, value: 49.4 },
{ year: 1945, value: 50.5 },
{ year: 1946, value: 52.0 },
{ year: 1947, value: 51.6 },
{ year: 1948, value: 50.6 },
{ year: 1949, value: 50.1 },
{ year: 1950, value: 51.6 },
{ year: 1951, value: 50.4 },
{ year: 1952, value: 51.1 },
{ year: 1953, value: 53.2 },
{ year: 1954, value: 52.8 },
{ year: 1955, value: 49.6 },
{ year: 1956, value: 51.5 },
{ year: 1957, value: 51.7 },
{ year: 1958, value: 53.6 },
{ year: 1959, value: 51.7 },
{ year: 1960, value: 51.9 },
{ year: 1961, value: 52.3 },
{ year: 1962, value: 50.6 },
{ year: 1963, value: 50.9 },
{ year: 1964, value: 48.3 },
{ year: 1965, value: 50.5 },
{ year: 1966, value: 52.4 },
{ year: 1967, value: 51.9 },
{ year: 1968, value: 50.3 },
{ year: 1969, value: 52.0 },
{ year: 1970, value: 51.6 },
{ year: 1971, value: 50.5 },
{ year: 1972, value: 52.3 },
{ year: 1973, value: 51.4 },
{ year: 1974, value: 52.9 },
{ year: 1975, value: 50.8 },
{ year: 1976, value: 51.6 },
{ year: 1977, value: 53.2 },
{ year: 1978, value: 53.3 },
{ year: 1979, value: 52.7 },
{ year: 1980, value: 52.8 },
{ year: 1981, value: 54.3 },
{ year: 1982, value: 51.0 },
{ year: 1983, value: 53.5 },
{ year: 1984, value: 51.0 },
{ year: 1985, value: 51.9 },
{ year: 1986, value: 52.7 },
{ year: 1987, value: 53.4 },
{ year: 1988, value: 53.3 },
{ year: 1989, value: 52.2 },
{ year: 1990, value: 53.4 },
{ year: 1991, value: 51.8 },
{ year: 1992, value: 53.6 },
{ year: 1993, value: 50.3 },
{ year: 1994, value: 54.7 },
{ year: 1995, value: 53.9 },
{ year: 1996, value: 54.3 },
{ year: 1997, value: 53.4 },
{ year: 1998, value: 52.9 },
{ year: 1999, value: 53.3 },
{ year: 2000, value: 53.7 },
{ year: 2001, value: 53.8 },
{ year: 2002, value: 52.0 },
{ year: 2003, value: 55.0 },
{ year: 2004, value: 52.1 },
{ year: 2005, value: 53.4 },
{ year: 2006, value: 53.8 },
{ year: 2007, value: 53.8 },
{ year: 2008, value: 51.9 },
{ year: 2009, value: 52.1 },
{ year: 2010, value: 52.7 },
{ year: 2011, value: 51.8 },
{ year: 2012, value: 56.6 },
{ year: 2013, value: 53.3 },
{ year: 2014, value: 55.6 },
{ year: 2015, value: 56.3 },
{ year: 2016, value: 56.2 },
{ year: 2017, value: 56.1 },
{ year: 2018, value: 56.2 },
{ year: 2019, value: 53.6 },
{ year: 2020, value: 55.7 },
{ year: 2021, value: 56.3 },
{ year: 2022, value: 55.9 },
{ year: 2023, value: 55.6 }];
    infoContainer.innerHTML = `
        <h3>About ${metric.name}</h3>
        <div class="info-grid">
            <div class="info-card">
                <h4>What is it?</h4>
                <p>${metric.description.what}</p>
            </div>
            <div class="info-card">
                <h4>Health Impacts</h4>
                <p>${metric.description.health}</p>
            </div>
            <div class="info-card">
                <h4>Effects</h4>
                <p>${metric.description.effects}</p>
            </div>
            <div class="info-card">
                <h4>Key Statistics</h4>
                <p>${metric.description.stats}</p>
            </div>
        </div>
        <div class="info-card">
            <h4>Danger Level Assessment</h4>
            <p>${metric.description.danger}</p>
        </div>
    `;
}
    

document.querySelector('.scroll-button').addEventListener('click', () => {
    const chart = document.getElementById('metricsChart');
    chart.scrollIntoView({ 
        behavior: 'smooth',
        block: 'center'
    });
});
    function createMetricCards() {
        const metricsGrid = document.getElementById('metricsGrid');
        metricsGrid.innerHTML = '';
        
        metrics.forEach(metric => {
            const latestValue = metric.data[metric.data.length - 28].value;
            const card = document.createElement('div');
            card.className = `metric-card ${metric.id === selectedMetric ? 'selected' : ''}`;
            card.innerHTML = `
                <h2>${metric.name}</h2>
                <div class="metric-value" style="color: ${metric.color}">
                    ${latestValue.toFixed(2)}
                </div>
                <div class="metric-label">Latest measurement</div>
            `;
            card.addEventListener('click', () => updateSelectedMetric(metric.id));
            metricsGrid.appendChild(card);
        });
    }
    
    function updateSelectedMetric(metricId) {
        selectedMetric = metricId;
        createMetricCards();
        updateChart();
        updateContaminantInfo(metricId); // Add this line

    }

    function updateChart() {
        const selectedMetricInfo = metrics.find(m => m.id === selectedMetric);
        const currentYear = 2024;

        const historicalData = selectedMetricInfo.data.filter(d => d.year < currentYear);
        const projectedData = selectedMetricInfo.data.filter(d => d.year >= currentYear);

        chart.data.datasets[0].data = historicalData.map(d => ({x: d.year, y: d.value}));
        chart.data.datasets[0].borderColor = selectedMetricInfo.color;
        chart.data.datasets[0].backgroundColor = selectedMetricInfo.color;

        chart.data.datasets[1].data = projectedData.map(d => ({x: d.year, y: d.value}));
        chart.data.datasets[1].borderColor = selectedMetricInfo.projectionColor;
        chart.data.datasets[1].backgroundColor = selectedMetricInfo.projectionColor;

        chart.data.datasets[2].data = selectedMetricInfo.data.map(d => ({
            x: d.year,
            y: selectedMetricInfo.safeLevel
        }));

        chart.options.scales.y.min = selectedMetricInfo.minValue;
        chart.options.scales.y.title.text = selectedMetricInfo.name;

        chart.update();
    }


    function createChart() {
    const ctx = document.getElementById('metricsChart').getContext('2d');
    const selectedMetricInfo = metrics.find(m => m.id === selectedMetric);
    const currentYear = 2024;

    const historicalData = selectedMetricInfo.data.filter(d => d.year < currentYear);
    const projectedData = selectedMetricInfo.data.filter(d => d.year >= currentYear);

    // Get the earliest year in the dataset
    const earliestDataYear = Math.min(...selectedMetricInfo.data.map(d => d.year));

    // Only show heat data for methane and co2
    const showHeatData = ['methane', 'co2'].includes(selectedMetric);

    const datasets = [
        {
            label: 'Historical Data',
            data: historicalData.map(d => ({x: d.year, y: d.value})),
            borderColor: selectedMetricInfo.color,
            backgroundColor: selectedMetricInfo.color,
            tension: 0.1,
            pointRadius: 4,
            pointHoverRadius: 8,
            yAxisID: 'y'
        },
        {
            label: 'Projected Data',
            data: projectedData.map(d => ({x: d.year, y: d.value})),
            borderColor: selectedMetricInfo.projectionColor,
            backgroundColor: selectedMetricInfo.projectionColor,
            tension: 0.1,
            pointRadius: 4,
            pointHoverRadius: 8,
            yAxisID: 'y'
        },
        {
            label: 'Recommended Maximum Level',
            data: selectedMetricInfo.data.map(d => ({
                x: d.year,
                y: selectedMetricInfo.safeLevel
            })),
            borderColor: 'rgba(128, 128, 128, 0.5)',
            borderWidth: 2,
            borderDash: [5, 5],
            pointRadius: 0,
            fill: false,
            yAxisID: 'y'
        }
    ];

    // Add heat data dataset if applicable
    if (showHeatData) {
        datasets.push({
            label: 'Temperature Data',
            data: heatData.map(d => ({x: d.year, y: d.value})),
            borderColor: 'rgba(255, 99, 71, 0.8)',
            backgroundColor: 'rgba(255, 99, 71, 0.8)',
            tension: 0.1,
            pointRadius: 3,
            pointHoverRadius: 6,
            yAxisID: 'y2'
        });
    }

    // Create annotations object
    const annotations = {
        projectionStart: {
            type: 'line',
            xMin: currentYear,
            xMax: currentYear,
            borderColor: 'rgba(0, 0, 0, 0.5)',
            borderWidth: 1,
            borderDash: [3, 3],
            label: {
                content: 'Projection Starts',
                enabled: true,
                position: 'start',
                yAdjust: +260
            }
        }
    };

    // Add Industrial Revolution annotation only if data extends before 1820
    if (earliestDataYear < 1820) {
        annotations.industrialRevolution = {
            type: 'line',
            xMin: 1820,
            xMax: 1820,
            borderColor: 'rgba(0, 0, 0, 0.5)',
            borderWidth: 1,
            borderDash: [3, 3],
            label: {
                content: 'Industrial Revolution',
                enabled: true,
                position: 'start',
                yAdjust: +260
            }
        };
    }
    

    chart = new Chart(ctx, {
        type: 'line',
        data: { datasets },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        usePointStyle: true,
                        padding: 20
                    }
                },
                tooltip: {
                    mode: 'nearest',
                    intersect: true,
                    callbacks: {
                        title: function(tooltipItems) {
                            return Math.floor(tooltipItems[0].parsed.x).toString(); // Format year without comma
                        },
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += context.parsed.y.toFixed(2);
                            }
                            return label;
                        }
                    }
                },
                annotation: {
                    annotations: annotations
                }
            },
            scales: {
                y: {
                    beginAtZero: false,
                    min: selectedMetricInfo.minValue,
                    position: 'left',
                    title: {
                        display: true,
                        text: selectedMetricInfo.name,
                        font: {
                            size: 14
                        }
                    }
                },
                y2: {
                    display: showHeatData,
                    position: 'right',
                    grid: {
                        drawOnChartArea: false
                    },
                    title: {
                        display: true,
                        text: 'Temperature (Â°C)',
                        font: {
                            size: 14
                        }
                    }
                },
                x: {
                    type: 'linear',
                    title: {
                        display: true,
                        text: 'Year',
                        font: {
                            size: 14
                        }
                    },
                    ticks: {
                        stepSize: 1,
                        callback: function(value) {
                            return Math.floor(value).toString(); // Formats the year without commas
                        }
                    }
                }
            },
            interaction: {
                mode: 'nearest',
                axis: 'x',
                intersect: true
            }
        },
        plugins: [{
            id: 'crosshair',
            afterDraw: (chart, args, options) => {
                const { ctx, chartArea, scales } = chart;
                const { top, bottom, left, right } = chartArea;
                
                if (chart._active && chart._active.length) {
                    const activePoint = chart._active[0];
                    const x = activePoint.element.x;
                    
                    // Draw vertical line
                    ctx.save();
                    ctx.beginPath();
                    ctx.moveTo(x, top);
                    ctx.lineTo(x, bottom);
                    ctx.lineWidth = 1;
                    ctx.strokeStyle = 'black';
                    ctx.stroke();
                    ctx.restore();
                }
            }
        }]
    });
}   

    // Initialize the dashboard
    updateContaminantInfo('lead');
    createMetricCards();
    createChart();
</script>
</body>
</html>